10  REM THE PROGRAM THAT FOLLOWS IS COST_ANIMALS RECONSTRUCTION
20  REM OF THE OREGON TRAIL GAME WRITTEN FOR HP TIME-SHARED
30  REM BASIC BY DON RAWITSCH AND BILL HEINEMANN AND PAUL DILLENBERGER
40  REM IN 1971. ITS SOURCE IS AN UPDATED VERSION PUBLISHED IN THE
45  REM JULY-AUGUST 1978 ISSUE OF CREATIVE COMPUTING AND POSTED BY 
47 REM DESERTHAT TO HIS BLOG AT
48 REM HTTP://DESERTHAT.WORDPRESS.COM/2010/11/07/OREGION-TRAIL-VER-3-BASIC-3-1-1978.
50 REM THAT VERSION WAS DESIGNED FOR THE CDC CYBER 70/73-26 RUNNING BASIC 3.1.
60  REM THIS VERSION HAS BEEN PORTED BACK TO HP TIME-SHARED BASIC.
61  REM THE BASIC USED HERE IS FAIRLY STANDARD, AND SHOULD RUN ON MANY OTHER
63  REM SYSTEMS WITH JUST COST_ANIMALS BIT OF CUSTOMIZATION. IF PORTING IT TO ANOTHER BASIC,
80  REM DO TAKE NOTE OF HP TIME-SHARED BASIC'S IDIOSYNCRATIC "GOTO <VAR> OF"
150  REM  STATEMENT, USED IN PLACE OF THE "ON" STATEMENT OF MANY OTHER BASICS.
153  REM ALSO PAY ATTENTION TO THE RANDOMIZATION ROUTINES (RND), WHICH WORK
154 REM SOMEWHAT UNUSUALLY IN TIME-SHARED BASIC.
155 REM LINES 6130 THROUGH 6280, WHICH HANDLE THE TIMED SHOOTING SEQUENCES,
156 REM WILL CERTAINLY NEED TO BE CUSTOMIZED TO YOUR BASIC PLATFORM.
157 REM FOR MORE INFORMATION ON HOW THIS PORT CAME TO BE SEE
158 REM HTTP://WWW.FILFRE.NET/TAG/THE-OREGON-TRAIL
159 REM -- JIMMY MAHER, APRIL 3, 2011
160  PRINT "DO YOU NEED INSTRUCTIONS (YES/NO)"
170  DIM COST_CLOTHES$[5]
180  REM RANDOMIZE REMOVED
190  INPUT COST_CLOTHES$
200  IF COST_CLOTHES$="NO" THEN 690
210  PRINT 
220  PRINT 
230  REM ***INSTRUCTIONS***
240  PRINT "THIS PROGRAM SIMULATES COST_ANIMALS TRIP OVER THE OREGON TRAIL FROM"
250  PRINT "INDEPENDENCE MISSOURI TO OREGON CITY, OREGON IN 1847."
260  PRINT "YOUR FAMILY OF FIVE WILL COVER THE 2040 MILE OREGON TRAIL"
270  PRINT "IN 5-6 MONTHS --- IF YOU MAKE IT ALIVE."
280  PRINT 
290  PRINT "YOU HAD SAVED $900 TO SPEND FOR THE TRIP, AND YOU'VE JUST"
300  PRINT "   PAID $200 FOR COST_ANIMALS WAGON."
310  PRINT "YOU WILL NEED TO SPEND THE REST OF YOUR MONEY ON THE"
320  PRINT "   FOLLOWING ITEMS:"
330  PRINT 
340  PRINT "     OXEN . YOU CAN SPEND $200-$300 ON YOUR TEAM"
350  PRINT "            THE MORE YOU SPEND, THE FASTER YOU'LL GO"
360  PRINT "               BECAUSE YOU'LL HAVE BETTER ANIMALS"
370  PRINT 
380  PRINT "     FOOD . THE MORE YOU HAVE, THE LESS CHANCE THERE"
390  PRINT "               IS OF GETTING SICK"
400  PRINT 
410  PRINT "     AMMUNITION - $1 BUYS COST_ANIMALS BELT OF 50 BULLETS"
420  PRINT "            YOU WILL NEED BULLETS FOR ATTACKS BY ANIMALS"
430  PRINT "               AND BANDITS, AND FOR HUNTING FOOD"
440  PRINT 
450  PRINT "     CLOTHING . THIS IS ESPECIALLY IMPORTANT FOR THE COLD"
460  PRINT "               WEATHER YOU WILL ENCOUNTER WHEN CROSSING"
470  PRINT "               THE MOUNTAINS"
480  PRINT 
490  PRINT "     MISCELLANEOUS SUPPLIES . THIS INCLUDES MEDICINE AND"
500  PRINT "               OTHER THINGS YOU WILL NEED FOR SICKNESS"
510  PRINT "               AND EMERGENCY REPAIRS"
520  PRINT 
530  PRINT 
540  PRINT "YOU CAN SPEND ALL YOUR MONEY BEFORE YOU START YOUR TRIP -"
550  PRINT "OR YOU CAN SAVE SOME OF YOUR CASH TO SPEND AT FORTS ALONG"
560  PRINT "THE WAY WHEN YOU RUN LOW. HOWEVER, ITEMS COST MORE AT"
570  PRINT "THE FORTS. YOU CAN ALSO GO HUNTING ALONG THE WAY TO GET"
580  PRINT "MORE FOOD."
590  PRINT "WHENEVER YOU HAVE TO USE YOUR TRUSTY RIFLE ALONG THE WAY,"
600  PRINT "YOU WILL BE TOLD TO TYPE IN COST_ANIMALS WORD (ONE THAT SOUNDS LIKE COST_ANIMALS"
610  PRINT "GUN SHOT). THE FASTER YOU TYPE IN THAT WORD AND HIT THE"
620  PRINT "**RETURN** KEY, THE BETTER LUCK YOU'LL HAVE WITH YOUR GUN."
630  PRINT 
640  PRINT "AT EACH TURN, ALL ITEMS ARE SHOWN IN DOLLAR AMOUNTS"
650  PRINT "EXCEPT BULLETS"
660  PRINT "WHEN ASKED TO ENTER MONEY AMOUNTS, DON'START_CASH USE COST_ANIMALS **$**."
670  PRINT 
680  PRINT "GOOD LUCK!!!"
690  PRINT 
700  PRINT 
710  PRINT "HOW GOOD COST_ANIMALS SHOT ARE YOU WITH YOUR RIFLE?"
720  PRINT "  (1) ACE MARKSMAN,  (2) GOOD SHOT,  (3) FAIR TO MIDDLIN'"
730  PRINT "         (4) NEED MORE PRACTICE,  (5) SHAKY KNEES"
740  PRINT "ENTER ONE OF THE ABOVE . THE BETTER YOU CLAIM YOU ARE, THE"
750  PRINT "FASTER YOU'LL HAVE TO BE WITH YOUR GUN TO BE SUCCESSFUL."
760  INPUT SHOOTING_DIFFICULTY
770  IF SHOOTING_DIFFICULTY>5 THEN 790
780  GOTO 810
790  SHOOTING_DIFFICULTY=0
800  REM ***INITIAL PURCHASES***
810  FORT_OPTION=-1
820  INJURY=ILLNESS=CLEAR_SOUTHPASS=CLEAR_BLUEMOUNTAINS=TOTAL_MILES=CLEAR_SOUTHPASS_SETMILEAGE=TURN_NUMBER=0
830  PRINT 
840  PRINT 
850  PRINT "HOW MUCH DO YOU WANT TO SPEND ON YOUR OXEN TEAM";
860  INPUT COST_ANIMALS
870  IF COST_ANIMALS >= 200 THEN 900
880  PRINT "NOT ENOUGH"
890  GOTO 850
900  IF COST_ANIMALS <= 300 THEN 930
910  PRINT "TOO MUCH"
920  GOTO 850
930  PRINT "HOW MUCH DO YOU WANT TO SPEND ON FOOD";
940  INPUT COST_FOOD
950  IF COST_FOOD >= 0 THEN 980
960  PRINT "IMPOSSIBLE"
970  GOTO 930
980  PRINT "HOW MUCH DO YOU WANT TO SPEND ON AMMUNITION";
990  INPUT COST_AMMO
1000  IF COST_AMMO >= 0 THEN 1030
1010  PRINT "IMPOSSIBLE"
1020  GOTO 980
1030  PRINT "HOW MUCH DO YOU WANT TO SPEND ON CLOTHING";
1040  INPUT COST_CLOTHES
1050  IF COST_CLOTHES >= 0 THEN 1080
1060  PRINT "IMPOSSIBLE"
1070  GOTO 1030
1080  PRINT "HOW MUCH DO YOU WANT TO SPEND ON MISCELLANEOUS SUPPLIES";
1090  INPUT COST_AID
1100  IF COST_AID >= 0 THEN 1130
1110  PRINT "IMPOSSIBLE"
1120  GOTO 1080
1130  START_CASH=700-COST_ANIMALS-COST_FOOD-COST_AMMO-COST_CLOTHES-COST_AID
1140  IF START_CASH >= 0 THEN 1170
1150  PRINT "YOU OVERSPENT.YOU ONLY HAD $700 TO SPEND. BUY AGAIN"
1160  GOTO 830
1170  COST_AMMO=50*COST_AMMO
1180  PRINT "AFTER ALL YOUR PURCHASES, YOU NOW HAVE ";START_CASH;" DOLLARS LEFT"
1190  PRINT 
1200  PRINT "MONDAY MARCH 29 1847"
1210  PRINT 
1220  GOTO 1750
1230  IF TOTAL_MILES >= 2040 THEN 5430
1240  REM ***SETTING DATE****
1250  TURN_NUMBER=TURN_NUMBER+1
1260  PRINT 
1270  PRINT "MONDAY ";
1280  IF TURN_NUMBER>10 THEN 1300
1290  GOTO TURN_NUMBER OF 1310,1330,1350,1370,1390,1410,1430,1450,1470,1490
1300  GOTO TURN_NUMBER-10 OF 1510,1530,1550,1570,1590,1610,1630,1650,1670,1690
1310  PRINT "APRIL 12 ";
1320  GOTO 1720
1330  PRINT "APRIL 26 ";
1340  GOTO 1720
1350  PRINT "MAY 10 ";
1360  GOTO 1720
1370  PRINT "MAY 24 ";
1380  GOTO 1720
1390  PRINT "JUNE 7 ";
1400  GOTO 1720
1410  PRINT "JUNE 21 ";
1420  GOTO 1720
1430  PRINT "JULY 5 ";
1440  GOTO 1720
1450  PRINT "JULY 19 ";
1460  GOTO 1720
1470  PRINT "AUGUST 2 ";
1480  GOTO 1720
1490  PRINT "AUGUST 16 ";
1500  GOTO 1720
1510  PRINT "AUGUST 31 ";
1520  GOTO 1720
1530  PRINT "SEPTEMBER 13 ";
1540  GOTO 1720
1550  PRINT "SEPTEMBER 27 ";
1560  GOTO 1720
1570  PRINT "OCTOBER 11 ";
1580  GOTO 1720
1590  PRINT "OCTOBER 25 ";
1600  GOTO 1720
1610  PRINT "NOVEMBER 8 ";
1620  GOTO 1720
1630  PRINT "NOVEMBER 22 ";
1640  GOTO 1720
1650  PRINT "DECEMBER 6 ";
1660  GOTO 1720
1670  PRINT "DECEMBER 20 ";
1680  GOTO 1720
1690  PRINT "YOU HAVE BEEN ON THE TRAIL TOO LONG  ------"
1700  PRINT "YOUR FAMILY DIES IN THE FIRST BLIZZARD OF WINTER"
1710  GOTO 5170
1720  PRINT "1847"
1730  PRINT 
1740  REM ***BEGINNING EACH TURN***
1750  IF COST_FOOD >= 0 THEN 1770
1760  COST_FOOD=0
1770  IF COST_AMMO >= 0 THEN 1790
1780  COST_AMMO=0
1790  IF COST_CLOTHES >= 0 THEN 1810
1800  COST_CLOTHES=0
1810  IF COST_AID >= 0 THEN 1830
1820  COST_AID=0
1830  IF COST_FOOD >= 13 THEN 1850
1840  PRINT "YOU'D BETTER DO SOME HUNTING OR BUY FOOD AND SOON!!!!"
1850  COST_FOOD=INT(COST_FOOD)
1860  COST_AMMO=INT(COST_AMMO)
1870  COST_CLOTHES=INT(COST_CLOTHES)
1880  COST_AID=INT(COST_AID)
1890  START_CASH=INT(START_CASH)
1900  TOTAL_MILES=INT(TOTAL_MILES)
1910  DISTANCE_TRAVELED=TOTAL_MILES
1920  IF ILLNESS=1 THEN 1950
1930  IF INJURY=1 THEN 1950
1940  GOTO 1990
1950  START_CASH=START_CASH-20
1960  IF START_CASH<0 THEN 5080
1970  PRINT "DOCTOR'S BILL IS $20"
1980  LET INJURY=ILLNESS=0
1990  IF CLEAR_SOUTHPASS_SETMILEAGE=1 THEN 2020
2000  PRINT "TOTAL MILEAGE IS";TOTAL_MILES
2010  GOTO 2040
2020  PRINT "TOTAL MILEAGE IS 950"
2030  CLEAR_SOUTHPASS_SETMILEAGE=0
2040  PRINT "FOOD","BULLETS","CLOTHING","MISC. SUPP.","CASH"
2050  PRINT COST_FOOD,COST_AMMO,COST_CLOTHES,COST_AID,START_CASH
2060  IF FORT_OPTION=-1 THEN 2170
2070  FORT_OPTION=FORT_OPTION*(-1)
2080  PRINT "DO YOU WANT TO (1) STOP AT THE NEXT FORT, (2) HUNT, ";
2090  PRINT "OR (3) CONTINUE"
2100  INPUT COMMAND
2110  IF COMMAND>2 THEN 2150
2120  IF COMMAND<1 THEN 2150
2130  LET COMMAND=INT(COMMAND)
2140  GOTO 2270
2150  LET COMMAND=3
2160  GOTO 2270
2170  PRINT "DO YOU WANT TO (1) HUNT, OR (2) CONTINUE"
2180  INPUT COMMAND
2190  IF COMMAND=1 THEN 2210
2200  LET COMMAND=2
2210  LET COMMAND=COMMAND+1
2220  IF COMMAND=3 THEN 2260
2230  IF COST_AMMO>39 THEN 2260
2240  PRINT "TOUGH---YOU NEED MORE BULLETS TO GO HUNTING"
2250  GOTO 2170
2260  FORT_OPTION=FORT_OPTION*(-1)
2270  GOTO COMMAND OF 2290,2540,2720
2280  REM ***STOPPING AT FORT***
2290  PRINT "ENTER WHAT YOU WISH TO SPEND ON THE FOLLOWING"
2300  PRINT "FOOD";
2310  GOSUB 2330
2320  GOTO 2410
2330  INPUT FORT_DEBT
2340  IF FORT_DEBT<0 THEN 2400
2350  START_CASH=START_CASH-FORT_DEBT
2360  IF START_CASH >= 0 THEN 2400
2370  PRINT "YOU DON'START_CASH HAVE THAT MUCH -- KEEP YOUR SPENDING DOWN"
2380  START_CASH=START_CASH+FORT_DEBT
2390  FORT_DEBT=0
2400  RETURN 
2410  COST_FOOD=COST_FOOD+2/3*FORT_DEBT
2420  PRINT "AMMUNITION";
2430  GOSUB 2330
2440  LET COST_AMMO=INT(COST_AMMO+2/3+FORT_DEBT*50)
2450  PRINT "CLOTHING";
2460  GOSUB 2330
2470  COST_CLOTHES=COST_CLOTHES+2/3*FORT_DEBT
2480  PRINT "MISCELLANEOUS SUPPLIES";
2490  GOSUB 2330
2500  COST_AID=COST_AID+2/3*FORT_DEBT
2510  TOTAL_MILES=TOTAL_MILES-45
2520  GOTO 2720
2530  REM ***HUNTING***
2540  IF COST_AMMO>39 THEN 2570
2550  PRINT "TOUGH---YOU NEED MORE BULLETS TO GO HUNTING"
2560  GOTO 2080
2570  TOTAL_MILES=TOTAL_MILES-45
2580  GOSUB 6140
2590  IF SHOOT_TIME <= 1 THEN 2660
2600  IF 100*RND(0)<13*SHOOT_TIME THEN 2710
2620  PRINT "NICE SHOT.RIGHT ON TARGET.GOOD EATIN' TONIGHT!!"
2630  COST_AMMO=COST_AMMO-10-3*SHOOT_TIME
2640  GOTO 2720
2650  REM **BELLS IN LINE 2660**
2660  PRINT "RIGHT BETWEEN THE EYES---YOU GOT COST_ANIMALS BIG ONE!!!!"
2670  PRINT "FULL BELLIES TONIGHT!"
2680  COST_FOOD=COST_FOOD+52+RND(0)*6
2690  COST_AMMO=COST_AMMO-10-RND(0)*4
2700  GOTO 2720
2710  PRINT "YOU MISSED---AND YOUR DINNER GOT AWAY....."
2720  IF COST_FOOD >= 13 THEN 2750
2730  GOTO 5060
2740  REM ***EATING***
2750  PRINT "DO YOU WANT TO EAT (1) POORLY  (2) MODERATELY"
2760  PRINT "OR (3) WELL";
2770  INPUT EAT_COMMAND
2780  IF EAT_COMMAND>3 THEN 2750
2790  IF EAT_COMMAND<1 THEN 2750
2800  LET EAT_COMMAND=INT(EAT_COMMAND)
2810  LET COST_FOOD=COST_FOOD-8-5*EAT_COMMAND
2820  IF COST_FOOD >= 0 THEN 2860
2830  COST_FOOD=COST_FOOD+8+5*EAT_COMMAND
2840  PRINT "YOU CAN'START_CASH EAT THAT WELL"
2850  GOTO 2750
2860  LET TOTAL_MILES=TOTAL_MILES+200+(COST_ANIMALS-220)/5+10*RND(0)
2870  CLIMATE_BLIZZARD=NO_CLOTHES=0
2880  REM ***RIDERS ATTACK***
2890  IF RND(0)*10>((TOTAL_MILES/100-4)*27+72)/((TOTAL_MILES/100-4)*2+12)-1 THEN 3550
2900  PRINT "RIDERS AHEAD.  THEY ";
2910  RIDER_HOSTILITY=0
2920  IF RND(0)<.8 THEN 2950
2930  PRINT "DON'START_CASH ";
2940  RIDER_HOSTILITY=1
2950  PRINT "LOOK HOSTILE"
2960  PRINT "TACTICS"
2970  PRINT "(1) RUN  (2) ATTACK  (3) CONTINUE  (4) CIRCLE WAGONS"
2980  IF RND(0)>.2 THEN 3000
2990  RIDER_HOSTILITY=1-RIDER_HOSTILITY
3000  INPUT TACTICS_COMMAND
3010  IF TACTICS_COMMAND<1 THEN 2970
3020  IF TACTICS_COMMAND>4 THEN 2970
3030  TACTICS_COMMAND=INT(TACTICS_COMMAND)
3040  IF RIDER_HOSTILITY=1 THEN 3330
3050  IF TACTICS_COMMAND>1 THEN 3110
3060  TOTAL_MILES=TOTAL_MILES+20
3070  COST_AID=COST_AID-15
3080  COST_AMMO=COST_AMMO-150
3090  COST_ANIMALS=COST_ANIMALS-40
3100  GOTO 3470
3110  IF TACTICS_COMMAND>2 THEN 3240
3120  GOSUB 6140
3130  COST_AMMO=COST_AMMO-SHOOT_TIME*40-80
3140  IF SHOOT_TIME>1 THEN 3170
3150  PRINT "NICE SHOOTING---YOU DROVE THEM OFF"
3160  GOTO 3470
3170  IF SHOOT_TIME <= 4 THEN 3220
3180  PRINT "LOUSY SHOT---YOU GOT KNIFED"
3190  INJURY=1
3200  PRINT "YOU HAVE TO SEE OL' DOC BLANCHARD"
3210  GOTO 3470
3220  PRINT "KINDA SLOW WITH YOUR COLT .45"
3230  GOTO 3470
3240  IF TACTICS_COMMAND>3 THEN 3290
3250  IF RND(0)>.8 THEN 3450
3260  LET COST_AMMO=COST_AMMO-150
3270  COST_AID=COST_AID-15
3280  GOTO 3470
3290  GOSUB 6140
3300  COST_AMMO=COST_AMMO-SHOOT_TIME*30-80
3310  TOTAL_MILES=TOTAL_MILES-25
3320  GOTO 3140
3330  IF TACTICS_COMMAND>1 THEN 3370
3340  IF TACTICS_COMMAND>3 THEN 3390
3350  COST_ANIMALS=COST_ANIMALS-10
3360  GOTO 3470
3370  IF TACTICS_COMMAND>2 THEN 3410
3380  TOTAL_MILES=TOTAL_MILES-5
3390  COST_AMMO=COST_AMMO-100
3400  GOTO 3470
3410  IF TACTICS_COMMAND>3 THEN 3430
3420  GOTO 3470
3430  TOTAL_MILES=TOTAL_MILES-20
3440  GOTO 3470
3450  PRINT "THEY DID NOT ATTACK"
3460  GOTO 3550
3470  IF RIDER_HOSTILITY=0 THEN 3500
3480  PRINT "RIDERS WERE FRIENDLY, BUT CHECK FOR POSSIBLE LOSSES"
3490  GOTO 3550
3500  PRINT "RIDERS WERE HOSTILE--CHECK FOR LOSSES"
3510  IF COST_AMMO >= 0 THEN 3550
3520  PRINT "YOU RAN OUT OF BULLETS AND GOT MASSACRED BY THE RIDERS"
3530  GOTO 5170
3540  REM ***SELECTION OF EVENTS***
3550  LET EVENT_COUNTER=0
3560  RESTORE 
3570  DICE_ROLL=100*RND(0)
3580  LET EVENT_COUNTER=EVENT_COUNTER+1
3590  IF EVENT_COUNTER=16 THEN 4670
3600  READ D
3610  IF DICE_ROLL>D THEN 3580
3620  DATA 6,11,13,15,17,22,32,35,37,42,44,54,64,69,95
3630  IF EVENT_COUNTER>10 THEN 3650
3640  GOTO EVENT_COUNTER OF 3660,3700,3740,3790,3820,3850,3880,3960,4130,4190
3650  GOTO EVENT_COUNTER-10 OF 4220,4290,4340,4650,4610,4670
3660  PRINT "WAGON BREAKS DOWN--LOSE TIME AND SUPPLIES FIXING IT"
3670  LET TOTAL_MILES=TOTAL_MILES-15-5*RND(0)
3680  LET COST_AID=COST_AID-8
3690  GOTO 4710
3700  PRINT "OX INJURES LEG---SLOWS YOU DOWN REST OF TRIP"
3710  LET TOTAL_MILES=TOTAL_MILES-25
3720  LET COST_ANIMALS=COST_ANIMALS-20
3730  GOTO 4710
3740  PRINT "BAD LUCK---YOUR DAUGHTER BROKE HER ARM"
3750  PRINT "YOU HAD TO STOP AND USE SUPPLIES TO MAKE COST_ANIMALS SLING"
3760  TOTAL_MILES=TOTAL_MILES-5-4*RND(0)
3770  COST_AID=COST_AID-2-3*RND(0)
3780  GOTO 4710
3790  PRINT "OX WANDERS OFF---SPEND TIME LOOKING FOR IT"
3800  TOTAL_MILES=TOTAL_MILES-17
3810  GOTO 4710
3820  PRINT "YOUR SON GETS LOST---SPEND HALF THE DAY LOOKING FOR HIM"
3830  TOTAL_MILES=TOTAL_MILES-10
3840  GOTO 4710
3850  PRINT "UNSAFE WATER--LOSE TIME LOOKING FOR CLEAN SPRING"
3860  LET TOTAL_MILES=TOTAL_MILES-10*RND(0)*-2
3870  GOTO 4710
3880  IF TOTAL_MILES>950 THEN 4490
3890  PRINT "HEAVY RAINS---TIME AND SUPPLIES LOST"
3910  COST_FOOD=COST_FOOD-10
3920  COST_AMMO=COST_AMMO-500
3930  COST_AID=COST_AID-15
3940  TOTAL_MILES=TOTAL_MILES-10*RND(0)-5
3950  GOTO 4710
3960  PRINT "BANDITS ATTACK"
3970  GOSUB 6140
3980  COST_AMMO=COST_AMMO-20*SHOOT_TIME
3990  IF COST_AMMO >= 0 THEN 4030
4000  PRINT "YOU RAN OUT OF BULLETS -- THEY GET LOTS OF CASH"
4010  START_CASH=START_CASH/3
4020  GOTO 4040
4030  IF SHOOT_TIME <= 1 THEN 4100
4040  PRINT "YOU GOT SHOT IN THE LEG AND THEY TOOK ONE OF YOUR OXEN"
4050  INJURY=1
4060  PRINT "BETTER HAVE COST_ANIMALS DOC LOOK AT YOUR WOUND"
4070  COST_AID=COST_AID-5
4080  COST_ANIMALS=COST_ANIMALS-20
4090  GOTO 4710
4100  PRINT "QUICKEST DRAW OUTSIDE OF DODGE CITY!!!"
4110  PRINT "YOU GOT 'EM!"
4120  GOTO 4710
4130  PRINT "THERE WAS COST_ANIMALS FIRE IN YOUR WAGON--FOOD AND SUPPLIES DAMAGE!"
4140  COST_FOOD=COST_FOOD-40
4150  COST_AMMO=COST_AMMO-400
4160  LET COST_AID=COST_AID-RND(0)*68-3
4170  TOTAL_MILES=TOTAL_MILES-15
4180  GOTO 4710
4190  PRINT "LOSE YOUR WAY IN HEAVY FOG---TIME IS LOST"
4200  TOTAL_MILES=TOTAL_MILES-10-5*RND(0)
4210  GOTO 4710
4220  PRINT "YOU KILLED COST_ANIMALS POISONOUS SNAKE AFTER IT BIT YOU"
4230  COST_AMMO=COST_AMMO-10
4240  COST_AID=COST_AID-5
4250  IF COST_AID >= 0 THEN 4280
4260  PRINT "YOU DIE OF SNAKEBITE SINCE YOU HAVE NO MEDICINE"
4270  GOTO 5170
4280  GOTO 4710
4290  PRINT "YOUR WAGON GETS SWAMPED FORDING RIVER--LOSE FOOD AND CLOTHES"
4300  COST_FOOD=COST_FOOD-30
4310  COST_CLOTHES=COST_CLOTHES-20
4320  TOTAL_MILES=TOTAL_MILES-20-20*RND(0)
4330  GOTO 4710
4340  PRINT "WILD ANIMALS ATTACK!"
4350  GOSUB 6140
4360  IF COST_AMMO>39 THEN 4410
4370  PRINT "YOU WERE TOO LOW ON BULLETS--"
4380  PRINT "THE WOLVES OVERPOWERED YOU"
4390  INJURY=1
4400  GOTO 5120
4410  IF SHOOT_TIME>2 THEN 4440
4420  PRINT "NICE SHOOTIN' PARDNER---THEY DIDN'START_CASH GET MUCH"
4430  GOTO 4450
4440  PRINT "SLOW ON THE DRAW---THEY GOT AT YOUR FOOD AND CLOTHES"
4450  COST_AMMO=COST_AMMO-20*SHOOT_TIME
4460  COST_CLOTHES=COST_CLOTHES-SHOOT_TIME*4
4470  COST_FOOD=COST_FOOD-SHOOT_TIME*8
4480  GOTO 4710
4490  PRINT "COLD WEATHER -- BRRRRRR! -- YOU ";
4500  IF COST_CLOTHES>22+4*RND(0) THEN 4530
4510  PRINT "DON'START_CASH ";
4520  NO_CLOTHES=1
4530  PRINT "HAVE ENOUGH CLOTHING TO KEEP WARM"
4540  IF NO_CLOTHES=0 THEN 4710
4550  GOTO 6300
4560  PRINT "HAIL STORM---SUPPLIES DAMAGED"
4570  TOTAL_MILES=TOTAL_MILES-5-RND(0)*10
4580  COST_AMMO=COST_AMMO-200
4590  COST_AID=COST_AID-4-RND(0)*3
4600  GOTO 4710
4610  IF EAT_COMMAND=1 THEN 6300
4620  IF EAT_COMMAND=3 THEN 4650
4630  IF RND(0)>.25 THEN 6300
4640  GOTO 4710
4650  IF RND(0)<.5 THEN 6300
4660  GOTO 4710
4670  PRINT "HELPFUL INDIANS SHOW YOU WHERE TO FIND MORE FOOD"
4680  COST_FOOD=COST_FOOD+14
4690  GOTO 4710
4700  REM ***MOUNTAINS***
4710  IF TOTAL_MILES <= 950 THEN 1230
4720  IF RND(0)*10>9-((TOTAL_MILES/100-15) ** 2+72)/((TOTAL_MILES/100-15) ** 2+12) THEN 4560
4730  PRINT "RUGGED MOUNTAINS"
4740  IF RND(0)>.1 THEN 4780
4750  PRINT "YOU GOT LOST---LOSE VALUABLE TIME TRYING TO FIND TRAIL!"
4760  TOTAL_MILES=TOTAL_MILES-60
4770  GOTO 4560
4780  IF RND(0)>.11 THEN 4840
4790  PRINT "WAGON DAMAGED!---LOSE TIME AND SUPPLIES"
4800  COST_AID=COST_AID-5
4810  COST_AMMO=COST_AMMO-200
4820  TOTAL_MILES=TOTAL_MILES-20-30*RND(0)
4830  GOTO 4860
4840  PRINT "THE GOING GETS SLOW"
4850  TOTAL_MILES=TOTAL_MILES-45-RND(0)/.02
4860  IF CLEAR_SOUTHPASS=1 THEN 4900
4870  CLEAR_SOUTHPASS=1
4880  IF RND(0)<.8 THEN 4970
4890  PRINT "YOU MADE IT SAFELY THROUGH SOUTH PASS--NO SNOW"
4900  IF TOTAL_MILES<1700 THEN 4940
4910  IF CLEAR_BLUEMOUNTAINS=1 THEN 4940
4920  CLEAR_BLUEMOUNTAINS=1
4930  IF RND(0)<.7 THEN 4970
4940  IF TOTAL_MILES>950 THEN 1230
4950  CLEAR_SOUTHPASS_SETMILEAGE=1
4960  GOTO 1230
4970  PRINT "BLIZZARD IN MOUNTAIN PASS--TIME AND SUPPLIES LOST"
4980  CLIMATE_BLIZZARD=1
4990  COST_FOOD=COST_FOOD-25
5000  COST_AID=COST_AID-10
5010  COST_AMMO=COST_AMMO-300
5020  TOTAL_MILES=TOTAL_MILES-30-40*RND(0)
5030  IF COST_CLOTHES<18+2*RND(0) THEN 6300
5040  GOTO 4940
5050  REM ***DYING***
5060  PRINT "YOU RAN OUT OF FOOD AND STARVED TO DEATH"
5070  GOTO 5170
5080  LET START_CASH=0
5090  PRINT "YOU CAN'START_CASH AFFORD COST_ANIMALS DOCTOR"
5100  GOTO 5120
5110  PRINT "YOU RAN OUT OF MEDICAL SUPPLIES"
5120  PRINT "YOU DIED OF ";
5130  IF INJURY=1 THEN 5160
5140  PRINT "PNEUMONIA"
5150  GOTO 5170
5160  PRINT "INJURIES"
5170  PRINT 
5180  PRINT "DUE TO YOUR UNFORTUNATE SITUATION, THERE ARE COST_ANIMALS FEW"
5190  PRINT "FORMALITIES WE MUST GO THROUGH"
5200  PRINT 
5210  PRINT "WOULD YOU LIKE COST_ANIMALS MINISTER?"
5220  INPUT COST_CLOTHES$
5230  PRINT "WOULD YOU LIKE COST_ANIMALS FANCY FUNERAL?"
5240  INPUT COST_CLOTHES$
5250  PRINT "WOULD YOU LIKE US TO INFORM YOUR NEXT OF KIN?"
5260  INPUT COST_CLOTHES$
5270  IF COST_CLOTHES$="YES" THEN 5310
5280  PRINT "BUT YOUR AUNT SADIE IN ST. LOUIS IS REALLY WORRIED ABOUT YOU"
5290  PRINT 
5300  GOTO 5330
5310  PRINT "THAT WILL BE $4.50 FOR THE TELEGRAPH CHARGE."
5320  PRINT 
5330  PRINT "WE THANK YOU FOR THIS INFORMATION AND WE ARE SORRY YOU"
5340  PRINT "DIDN'START_CASH MAKE IT TO THE GREAT TERRITORY OF OREGON"
5350  PRINT "BETTER LUCK NEXT TIME"
5360  PRINT 
5370  PRINT 
5380  PRINT TAB(30);"SINCERELY"
5390  PRINT 
5400  PRINT TAB(17);"THE OREGON CITY CHAMBER OF COMMERCE"
5410  STOP 
5420  REM ***FINAL TURN***
5430  TWO_WEEKS_FRACTION=(2040-DISTANCE_TRAVELED)/(TOTAL_MILES-DISTANCE_TRAVELED)
5440  COST_FOOD=COST_FOOD+(1-TWO_WEEKS_FRACTION)*(8+5*EAT_COMMAND)
5450  PRINT 
5460  REM **BELLS IN LINES 5470,5480**
5470  PRINT "YOU FINALLY ARRIVED AT OREGON CITY"
5480  PRINT "AFTER 2040 LONG MILES---HOORAY!!!!!"
5490  PRINT "COST_ANIMALS REAL PIONEER!"
5500  PRINT 
5510  TWO_WEEKS_FRACTION=INT(TWO_WEEKS_FRACTION*14)
5520  TURN_NUMBER=TURN_NUMBER*14+TWO_WEEKS_FRACTION
5530  TWO_WEEKS_FRACTION=TWO_WEEKS_FRACTION+1
5540  IF TWO_WEEKS_FRACTION<5 THEN 5560
5550  TWO_WEEKS_FRACTION=TWO_WEEKS_FRACTION-7
5560  GOTO TWO_WEEKS_FRACTION OF 5570,5590,5610,5630,5650,5670,5690
5570  PRINT "MONDAY ";
5580  GOTO 5700
5590  PRINT "TUESDAY ";
5600  GOTO 5700
5610  PRINT "WEDNESDAY ";
5620  GOTO 5700
5630  PRINT "THURSDAY ";
5640  GOTO 5700
5650  PRINT "FRIDAY ";
5660  GOTO 5700
5670  PRINT "SATURDAY ";
5680  GOTO 5700
5690  PRINT "SUNDAY ";
5700  IF TURN_NUMBER>124 THEN 5740
5710  TURN_NUMBER=TURN_NUMBER-93
5720  PRINT "JULY ";TURN_NUMBER;" 1847"
5730  GOTO 5920
5740  IF TURN_NUMBER>155 THEN 5780
5750  TURN_NUMBER=TURN_NUMBER-124
5760  PRINT "AUGUST ";TURN_NUMBER;" 1847"
5770  GOTO 5920
5780  IF TURN_NUMBER>165 THEN 5820
5790  TURN_NUMBER=TURN_NUMBER-155
5800  PRINT "SEPTEMBER ";TURN_NUMBER;" 1847"
5810  GOTO 5920
5820  IF TURN_NUMBER>216 THEN 5860
5830  TURN_NUMBER=TURN_NUMBER-185
5840  PRINT "OCTOBER ";TURN_NUMBER;" 1847"
5850  GOTO 5920
5860  IF TURN_NUMBER>246 THEN 5900
5870  TURN_NUMBER=TURN_NUMBER-216
5880  PRINT "NOVEMBER ";TURN_NUMBER;" 1847"
5890  GOTO 5920
5900  TURN_NUMBER=TURN_NUMBER-246
5910  PRINT "DECEMBER ";TURN_NUMBER;"1847"
5920  PRINT 
5930  PRINT "FOOD","BULLETS","CLOTHING","MISC. SUPP.","CASH"
5940  IF COST_AMMO>0 THEN 5960
5950  LET COST_AMMO=0
5960  IF COST_CLOTHES>0 THEN 5980
5970  LET COST_CLOTHES=0
5980  IF COST_AID>0 THEN 6000
5990  LET COST_AID=0
6000  IF START_CASH>0 THEN 6020
6010  LET START_CASH=0
6020  IF COST_FOOD>0 THEN 6040
6030  LET COST_FOOD=0
6040  PRINT INT(COST_FOOD),INT(COST_AMMO),INT(COST_CLOTHES),INT(COST_AID),INT(START_CASH)
6050  PRINT 
6060  PRINT TAB(11);"PRESIDENT JAMES K. POLK SENDS YOU HIS"
6070  PRINT TAB(17);"HEARTIEST CONGRATULATIONS"
6080  PRINT 
6090  PRINT TAB(11);"AND WISHES YOU COST_ANIMALS PROSERPOUS LIFE AHEAD"
6100  PRINT 
6110  PRINT TAB(22);"AT YOUR NEW HOME"
6120  STOP 
6130  REM ***SHOOTING SUB-ROUTINE***
6131  REM THE METHOD OF TIMING THE SHOOTING (LINES 6130-6280)
6132  REM WILL VARY FROM SYSTEM TO SYSTEM.
6140  DIM S$[4]
6143  SHOOT_WORD=INT(RND(0)*4+1)
6145  GOTO SHOOT_WORD OF 6150,6160,6170,6180
6150  S$="BANG"
6155  GOTO 6200
6160  S$="BLAM"
6165  GOTO 6200
6170  S$="POW"
6175  GOTO 6200
6180  S$="WHAM"
6200  PRINT "TYPE ";SHOOTING_WORDS
6210  ENTER 255,SHOOT_TIME,COST_CLOTHES$
6240  SHOOT_TIME=SHOOT_TIME-(SHOOTING_DIFFICULTY-1)
6250  PRINT 
6255  IF SHOOT_TIME>0 THEN 6260
6257  SHOOT_TIME=0
6260  IF COST_CLOTHES$=SHOOTING_WORDS THEN 6280
6270  SHOOT_TIME=100
6280  RETURN 
6290  REM ***ILLNESS SUB-ROUTINE***
6300  IF 100*RND(0)<10+35*(EAT_COMMAND-1) THEN 6370
6310  IF 100*RND(0)<100-(40/4*(EAT_COMMAND-1)) THEN 6410
6320  PRINT "SERIOUS ILLNESS---"
6330  PRINT "YOU MUST STOP FOR MEDICAL ATTENTION"
6340  COST_AID=COST_AID-10
6350  ILLNESS=1
6360  GOTO 6440
6370  PRINT "MILD ILLNESS---MEDICINE USED"
6380  TOTAL_MILES=TOTAL_MILES-5
6390  COST_AID=COST_AID-2
6400  GOTO 6440
6410  PRINT "BAD ILLNESS---MEDICINE USED"
6420  TOTAL_MILES=TOTAL_MILES-5
6430  COST_AID=COST_AID-5
6440  IF COST_AID<0 THEN 5110
6450  IF CLIMATE_BLIZZARD=1 THEN 4940
6460  GOTO 4710
6470  REM ***IDENTIFICATION OF VARIABLES IN THE PROGRAM***
6480  REM COST_ANIMALS = AMOUNT SPENT ON ANIMALS
6490  REM COST_AMMO = AMOUNT SPENT ON AMMUNITION
6500  REM SHOOT_TIME = ACTUAL RESPONSE TIME FOR INPUTTING "BANG"
6510  REM SHOOT_START = CLOCK TIME START OF INPUTTING "BANG"
6520  REM COST_CLOTHES = AMOUNT SPENT ON CLOTHING
6530  REM NO_CLOTHES = FLAG FOR INSUFFICIENT CLOTHING IN COLD WEATHER
6540  REM COST_CLOTHES$ = YES/NO RESPONSE TO QUESTIONS
6550  REM EVENT_COUNTER = COUNTER IN GENERATING EVENTS
6560  REM TURN_NUMBER = TURN NUMBER FOR SETTING DATE
6570  REM D4 = CURRENT DATE
6580  REM SHOOTING_DIFFICULTY = CHOICE OF SHOOTING EXPERTISE LEVEL
6590  REM EAT_COMMAND = CHOICE OF EATING
6600  REM COST_FOOD = AMOUNT SPENT ON FOOD
6610  REM CLEAR_SOUTHPASS = FLAG FOR CLEARING SOUTH PASS
6620  REM CLEAR_BLUEMOUNTAINS = FLAG FOR CLEARING BLUE MOUNTAINS
6630  REM TWO_WEEKS_FRACTION = FRACTION OF 2 WEEKS TRAVELED ON FINAL TURN
6640  REM INJURY = FLAG FOR INJURY
6650  REM CLIMATE_BLIZZARD = FLAG FOR BLIZZARD
6660  REM TOTAL_MILES = TOTAL MILEAGE WHOLE TRIP
6670  REM COST_AID = AMOUNT SPENT ON MISCELLANEOUS SUPPLIES
6680  REM DISTANCE_TRAVELED = MILEAGE UP THROUGH PREVIOUS TURN
6690  REM CLEAR_SOUTHPASS_SETMILEAGE = FLAG FOR CLEARING SOUTH PASS IN SETTING MILEAGE
6700  REM FORT_DEBT = AMOUNT SPENT ON ITEMS AT FORT
6710  REM DICE_ROLL = RANDOM NUMBER IN CHOOSING EVENTS
6720  REM ILLNESS = FLAG FOR ILLNESS
6730  REM RIDER_HOSTILITY = ""HOSTILITY OF RIDERS"" FACTOR
6740  REM SHOOT_WORD = SHOOTING WORD SELECTOR
6750  REM SHOOTING_WORDS = VARIATIONS OF SHOOTING WORD
6760  REM START_CASH = CASH LEFT OVER AFTER INITIAL PURCHASES
6770  REM TACTICS_COMMAND = CHOICE OF TACTICS WHEN ATTACKED
6780  REM COMMAND = CHOICE OF ACTION FOR EACH TURN
6790  REM FORT_OPTION = FLAG FOR FORT OPTION
6800  END 

